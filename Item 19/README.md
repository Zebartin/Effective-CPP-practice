# Item 19: Treat class design as type design.

在C++中，与其他面向对象语言一样，定义一个新的类就相当于定义了一个新类型。在设计类的时候，需要回答以下问题：

- 这个类如何创建和销毁新对象？

  影响到构造函数和析构函数的设计，以及内存分配和释放的方式。

- 这个类的初始化和赋值操作有什么不同之处？

  影响到构造函数和赋值运算符的不同设计。

- 这个类的对象按值传递（pass by value）时会发生什么？

  关系到复制构造函数的实现。

- 这个类对合法的取值范围有什么要求？

  这些要求会使得类中存在一些常量，它们决定了如何校验、抛出什么样的异常等等。

- 这个类在某个继承图系（inheritance graph）中吗？

  关系到虚函数的声明和继承。

- 这个类允许什么样的类型转换？

  - 隐式转换：重载类型转换操作符，或者在目标类里定义非`explicit`的构造函数；
  - 显式转换：通过成员函数进行类型转换，同时避免上述隐式转换的函数。

- 这个类允许什么样的函数和运算符？

- 这个类不允许哪些标准函数？

  需要手动把它们声明为`private`。

- 谁能够获取到这个类的成员变量？

- 这个类“未声明的接口”是怎样的？

  包括性能、异常安全、资源使用等等，这些内在要求限制了类的具体实现。

- 这个类通用程度几何？

  可能你不是在定义一个类型，而是在定义一大群类型。这种情况下应定义一个类模板。

- 你需要的真的是一个新类型吗？

  或许简单的几个非成员函数/模板就能解决问题。

## 总结

类设计就是类型设计。在定义一个新类型之前，务必要好好考虑上述提及的这些问题。

<a href="../Item%2018"><-</a>

<a href="../Item%2020">-></a>
